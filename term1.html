<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Linux Terminal Simulator - Extended</title>
<style>
  body {
    background-color: #000;
    color: #33ff33;
    font-family: monospace;
    margin: 0;
    padding: 20px;
    height: 100vh;
    overflow: hidden;
  }
  #terminal {
    height: 90vh;
    overflow-y: auto;
    white-space: pre-wrap;
  }
  #input-line {
    display: flex;
  }
  #prompt {
    user-select: none;
  }
  #cmdline {
    background: transparent;
    border: none;
    color: #33ff33;
    outline: none;
    font-family: monospace;
    flex: 1;
    font-size: 1em;
    caret-color: #33ff33;
  }
  ::selection {
    background: #33ff33;
    color: black;
  }
  /* Blinking cursor effect on input */
  #cmdline {
    animation: blink-caret 1s step-start infinite;
  }
  @keyframes blink-caret {
    50% { border-right: 2px solid #33ff33; }
    100% { border-right: none; }
  }
</style>
</head>
<body>

<div id="terminal">
  <div>Welcome to Linux Terminal Simulator! Type 'help' to see commands.</div>
</div>

<div id="input-line">
  <span id="prompt">user@simulator:~$&nbsp;</span>
  <input type="text" id="cmdline" autofocus autocomplete="off" spellcheck="false" />
</div>

<script>
  const terminal = document.getElementById('terminal');
  const cmdline = document.getElementById('cmdline');

  // Simulated file system
  const files = {
    'readme.txt': 'This is a Linux terminal simulator created using HTML, CSS and JavaScript.',
    'notes.txt': 'Remember to practice commands daily!',
    'todo.txt': '1. Learn more about bash\n2. Improve JavaScript skills\n3. Build a real shell',
    'hello world.txt': 'Hello, World!\nWelcome to the simulated Linux environment.'
  };

  // Command history
  let history = [];
  let historyIndex = -1;

  const commands = {
    help: () => {
      return `Available commands:
help       - Show this help message
ls         - List directory contents
pwd        - Print working directory
echo       - Display a line of text
date       - Show current date and time
clear      - Clear the terminal screen
cat        - Show contents of a file. Usage: cat filename
whoami     - Show current user
history    - Show command history
uname      - Show system information`;
    },
    ls: () => {
      // List all simulated files plus some folders
      return 'Desktop Documents Downloads Music Pictures Public Templates Videos\n' + Object.keys(files).join(' ');
    },
    pwd: () => {
      return '/home/user';
    },
    echo: (args) => {
      return args.join(' ');
    },
    date: () => {
      return new Date().toString();
    },
    clear: () => {
      terminal.innerHTML = '';
      return '';
    },
    cat: (args) => {
      if (args.length === 0) {
        return 'cat: missing filename';
      }
      const filename = args.join(' ');
      if (files.hasOwnProperty(filename)) {
        return files[filename];
      } else {
        return `cat: ${filename}: No such file or directory`;
      }
    },
    whoami: () => {
      return 'user';
    },
    history: () => {
      if (history.length === 0) return 'No commands in history.';
      return history.map((cmd, i) => `${i + 1}  ${cmd}`).join('\n');
    },
    uname: () => {
      return 'Linux Simulator 1.0';
    }
  };

  function printOutput(text) {
    if(text === '') return; // don't print empty lines(for clear)
    const div = document.createElement('div');
    div.textContent = text;
    terminal.appendChild(div);
    terminal.scrollTop = terminal.scrollHeight;
  }

  cmdline.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      const input = cmdline.value.trim();
      if (input.length === 0) return;

      printOutput(`user@simulator:~$ ${input}`);
      history.push(input);
      historyIndex = history.length;

      const [cmd, ...args] = input.split(/\s+/);
      if (commands.hasOwnProperty(cmd)) {
        const output = commands[cmd](args);
        if (output) printOutput(output);
      } else {
        printOutput(`bash: ${cmd}: command not found`);
      }
      cmdline.value = '';
    }
    else if (e.key === 'ArrowUp') {
      e.preventDefault();
      if (history.length === 0) return;
      if (historyIndex > 0) historyIndex--;
      cmdline.value = history[historyIndex] || '';
      // Move cursor to end
      setTimeout(() => cmdline.selectionStart = cmdline.selectionEnd = cmdline.value.length, 0);
    }
    else if (e.key === 'ArrowDown') {
      e.preventDefault();
      if (history.length === 0) return;
      if (historyIndex < history.length - 1) historyIndex++;
      else {
        historyIndex = history.length;
        cmdline.value = '';
        return;
      }
      cmdline.value = history[historyIndex] || '';
      // Move cursor to end
      setTimeout(() => cmdline.selectionStart = cmdline.selectionEnd = cmdline.value.length, 0);
    }
  });
</script>

</body>
</html>
